<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<?xml-stylesheet type="text/xsl" href="modx.prosilver.en.xsl"?>
<!--For security purposes, please check: http://www.phpbb.com/mods/ for the latest version of this MOD. Although MODs are checked before being allowed in the MODs Database there is no guarantee that there are no security problems within the MOD. No support will be given for MODs not found within the MODs Database which can be found at http://www.phpbb.com/mods/-->
<mod xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.phpbb.com/mods/xml/modx-1.2.5.xsd">
	<header>
		<license>http://opensource.org/licenses/gpl-license.php GNU General Public License v2</license>
		
		<title lang="en">phpBB Statistics</title>
		<title lang="de">phpBB Statistics</title>
		
		<description lang="en">This modification displays many different statistics of your board. These can be controlled via the ACP.</description>
		<description lang="de"><![CDATA[Dieser Mod zeigt verschiedene Statistiken von deinem Forum an. Diese können im Admin-Bereich kontrolliert werden.]]></description>
		
		<author-notes lang="en">This MOD requires PHP5.</author-notes>
		<author-notes lang="de">Dieser MOD benötigt PHP5.</author-notes>
		
		<author-group>
			<author>
				<realname>Marc Alexander</realname>
				<email>admin@m-a-styles.de</email>
				<username>marc1706</username>
				<homepage>http://www.m-a-styles.de</homepage>
				<contributions-group>
					<contributions status="current" position="Developer"/>
				</contributions-group>
			</author>
		</author-group>
		
		<mod-version>2.0.0RC1</mod-version>
		<installation>
		  <level>easy</level>
		  <time>300</time>
		<target-version>3.0.11</target-version>
		</installation>

		<history>
			<entry>
				<date>2012-06-17</date>
				<rev-version>2.0.0RC1</rev-version>
				<changelog lang="en">
					<change>New Base</change>
				</changelog>
				<changelog lang="de">
					<change>Neue Basis</change>
				</changelog>
			</entry>
		</history>
		<link-group>
			<link type="template" lang="de" href="contrib/subsilver2.xml">subsilver2</link>
			<link type="template" lang="en-gb" href="contrib/subsilver2.xml">subsilver2</link>
			<link type="contrib" lang="en" href="contrib/update_phpbbstatistics_1.0.2/update_phpbbstatistics_1.0.2.xml">Update instructions for phpBB Statistics Version 1.0.2</link>
			<link type="contrib" lang="de" href="contrib/update_phpbbstatistics_1.0.2/update_phpbbstatistics_1.0.2.xml">Updateanleitung für phpBB Statistics Version 1.0.2</link>
			<link type="language" lang="de" href="contrib/de.xml">Deutsch</link>
			<link type="language" lang="en-gb" href="contrib/de.xml">German</link>
		</link-group>
	</header>
	<action-group>
	<copy>
			<file from="root/adm/*.*" to="adm/*.*" />
			<file from="root/includes/acp/*.*" to="includes/acp/*.*" />
<!--			<file from="root/includes/stats/*.*" to="includes/stats/*.*" /> -->
			<file from="root/install/*.*" to="install/*.*" />
			<file from="root/language/en/mods/*.*" to="language/en/mods/*.*" />
			<file from="root/stats/*.*" to="stats/*.*" />
			<file from="root/styles/prosilver/template/stats/*.*" to="styles/prosilver/template/stats/*.*" />
			<file from="root/styles/prosilver/theme/stats.css" to="styles/prosilver/theme/stats.css" />
			<file from="root/stats.php" to="stats.php" />
			<file from="root/umil/*.*" to="umil/*.*" />
		</copy>
	<open src="adm/style/acp_profile.html">
			<edit>
				<find><![CDATA[		<!-- IF S_EDIT_MODE -->
			<fieldset class="quick">
				<input class="button1" type="submit" name="save" value="{L_SAVE}" />
			</fieldset>
		<!-- ENDIF -->]]></find>
				<action type="before-add"><![CDATA[		<!-- IF S_DISPLAY_FIELD_STATS_SHOW -->
		<fieldset>
			<legend>{L_STATS}</legend>
		<dl>
			<dt><label for="field_stats_show">{L_FIELD_STATS_SHOW}:</label><br /><span>{L_FIELD_STATS_SHOW_EXPLAIN}</span></dt>
			<dd><label><input type="radio" class="radio" id="field_stats_show" name="field_stats_show" value="1"<!-- IF S_FIELD_STATS_SHOW --> checked="checked"<!-- ENDIF --> /> {L_YES}</label>
				<label><input type="radio" class="radio" name="field_stats_show" value="0"<!-- IF not S_FIELD_STATS_SHOW --> checked="checked"<!-- ENDIF --> /> {L_NO}</label></dd>
		</dl>
		</fieldset>
		<!-- ENDIF -->]]></action>
			</edit>
		</open>
		<open src="includes/acp/acp_profile.php">
			<edit>
				<find><![CDATA[						'lang_explain'		=> '',]]></find>
				<action type="after-add"><![CDATA[						// phpBB Statistics MOD
						'field_stats_show'		=> request_var('field_stats_show', 0),
						// END MOD]]></action>
			</edit>
			<edit>
				<find><![CDATA[1	=> array('field_ident', 'lang_name', 'lang_explain', 'field_option_none', 'field_show_on_reg', 'field_show_on_vt', 'field_required', 'field_hide', 'field_show_profile', 'field_no_view'),]]></find>
				<inline-edit>
					<inline-find><![CDATA['field_no_view']]></inline-find>
					<inline-action type="after-add"><![CDATA[, 'field_stats_show']]></inline-action>
				</inline-edit>
			</edit>
			<edit>
				<find><![CDATA[				$cp->vars['lang_default_value']	= utf8_normalize_nfc(request_var('lang_default_value', $field_row['lang_default_value'], true));]]></find>
				<action type="after-add"><![CDATA[				// phpBB Statistics MOD
				$cp->vars['field_stats_show']		= request_var('field_stats_show', $field_row['field_stats_show']);
				//END MOD]]></action>
			</edit>
			<edit>
				<find><![CDATA[							'LANG_NAME'			=> $cp->vars['lang_name'],]]></find>
				<action type="after-add"><![CDATA[							// phpBB Statistics MOD
							'S_FIELD_STATS_SHOW'	=> $cp->vars['field_stats_show'],
							'S_DISPLAY_FIELD_STATS_SHOW'	=> in_array($field_type, array(FIELD_STRING, FIELD_BOOL, FIELD_DROPDOWN)),
							//END MOD]]></action>
			</edit>
			<edit>
				<find><![CDATA[			'field_show_profile'	=> $cp->vars['field_show_profile'],]]></find>
				<action type="after-add"><![CDATA[			// phpBB Statistics MOD
			'field_stats_show'			=> $cp->vars['field_stats_show'],
			//END MOD]]></action>
			</edit>
		</open>
		<open src="includes/functions.php">
			<edit>
				<find><![CDATA[// The following assigns all _common_ variables that may be used at any point in a template.]]></find>
				<action type="before-add"><![CDATA[	if ($auth->acl_get('u_view_stats'))
	{
		$template->assign_var('S_VIEW_STATS', true);
	}]]></action>
			</edit>	
			<edit>
				<find><![CDATA['U_PRIVATEMSGS'			=> append_sid("{$phpbb_root_path}ucp.$phpEx", 'i=pm&amp;folder=inbox'),]]></find>
				<action type="before-add"><![CDATA[		'U_STATS'				=> ($auth->acl_get('u_view_stats')) ? append_sid("{$phpbb_root_path}stats.$phpEx") : '',]]></action>
			</edit>			
		</open>
		<open src="language/en/acp/common.php">
			<edit>
				<find><![CDATA[?>]]></find>
				<action type="before-add"><![CDATA[// phpBB Statistics MOD
$lang = array_merge($lang, array(
	'STATS'							=> 'phpBB Statistics',	
	'STATS_BASIC'						=> 'Basic statistics',
	'STATS_BASIC_BASIC'				=> 'Basic',
	'STATS_BASIC_ADVANCED'				=> 'Advanced',
	'STATS_BASIC_MISCELLANEOUS'		=> 'Miscellaneous',
	'STATS_ACTIVITY'					=> 'Forum Activity',
	'STATS_ACTIVITY_FORUMS'			=> 'Forums',
	'STATS_ACTIVITY_TOPICS'			=> 'Topics',
	'STATS_ACTIVITY_USERS'				=> 'Users',
	'STATS_CONTRIBUTIONS'				=> 'Forum Contributions',
	'STATS_CONTRIBUTIONS_ATTACHMENTS'	=> 'Attachments',
	'STATS_CONTRIBUTIONS_POLLS'		=> 'Polls',
	'STATS_PERIODIC'					=> 'Periodic Statistics',
	'STATS_PERIODIC_DAILY'				=> 'Daily Statistics',
	'STATS_PERIODIC_MONTHLY'			=> 'Monthly Statistics',
	'STATS_PERIODIC_HOURLY'			=> 'Hourly Statistics',
	'STATS_SETTINGS'					=> 'Settings Statistics',
	'STATS_SETTINGS_BOARD'				=> 'Board Settings',
	'STATS_SETTINGS_PROFILE'			=> 'Profile Settings',
	'STATS_ADDONS'					=> 'Add-Ons',
	'STATS_ADDONS_MISCELLANEOUS'		=> 'scapegoat', // do not change
	
	'LOG_STATS_CONFIG_SETTINGS'				=> '<strong>phpBB Statistics: Altered General settings</strong>',
	'LOG_STATS_CONFIG_ADDONS'				=> '<strong>phpBB Statistics: Altered Add-ons Settings</strong>',
	'LOG_STATS_ADDON_REMOVED'				=> '<strong>phpBB Statistics: Removed %1$s add-on</strong>',
	'LOG_STATS_ADDON_ENABLED'				=> '<strong>phpBB Statistics: Enabled %1$s add-on</strong>',
	'LOG_STATS_ADDON_DISABLED'				=> '<strong>phpBB Statistics: Disabled %1$s add-on</strong>',
	
	'FIELD_STATS_SHOW'					=> 'Show this custom profile field on the Forum Statistics page',
	'FIELD_STATS_SHOW_EXPLAIN'					=> 'Enabling this will make this custom profile field to be shown as a statistic under the Profile Settings statistics on the Forum Statistics page. Note that deactivated or hidden custom profile fields are not shown on the Forum Statistics page even if this option is enabled.<br />The display of this statistic will depend on the type of data that this field stores.',
	
	'acl_u_view_stats'		=> array('lang' => 'Can view Statistics', 'cat' => 'misc'),

));
//END MOD]]></action>
			</edit>
		</open>	
		<open src="viewonline.php">
			<edit>
				<find><![CDATA[		case 'report':
			$location = $user->lang['REPORTING_POST'];
			$location_url = append_sid("{$phpbb_root_path}index.$phpEx");
		break;]]></find>
				<action type="after-add"><![CDATA[		case 'stats':
			$user->add_lang('mods/stats');
			$location = $user->lang['VIEWING_STATS'];
			$location_url = append_sid("{$phpbb_root_path}stats.$phpEx");
		break;]]></action>
			</edit>
		</open>
		<open src="styles/prosilver/template/overall_header.html">
			<edit>
				<find><![CDATA[<li class="icon-faq"><a href="{U_FAQ}" title="{L_FAQ_EXPLAIN}">{L_FAQ}</a></li>]]></find>
				<action type="after-add"><![CDATA[				<!-- IF S_VIEW_STATS --><li class="icon-faq"><a href="{U_STATS}" title="{L_STATS_EXPLAIN}">{L_STATISTICS}</a></li><!-- ENDIF -->]]></action>
			</edit>
		</open>
		<open src="styles/prosilver/theme/stylesheet.css">
			<edit>
				<find><![CDATA[@import url("colours.css");]]></find>
				<action type="after-add"><![CDATA[@import url("stats.css");]]></action>
			</edit>
		</open>
		<php-installer>install/index.php</php-installer>
		<diy-instructions lang="en">
Remember to purge the cache and refresh the theme and template cache after running the installer. Now you are ready to enjoy your new phpBB Statistics.  ;)

		</diy-instructions>
		<diy-instructions lang="de">
Bitte danach nicht vergessen den Forum Cache, Template Cache und Theme Cache zu leeren. ;)</diy-instructions>
	</action-group>
</mod>